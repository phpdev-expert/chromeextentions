(window["webpackJsonpsimple-secure-ext"]=window["webpackJsonpsimple-secure-ext"]||[]).push([[0],{210:function(e,t,n){e.exports=n(288)},215:function(e,t,n){},221:function(e,t){},288:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),l=n(33),c=n.n(l),o=(n(215),n(56)),i=Object(o.b)({styles:{global:{"html, body":{fontSize:"16px"}}},colors:{darkpurple:{50:"#efedfc",100:"#cfcbe7",200:"#afa8d4",300:"#8f85c3",400:"#7064b2",500:"#574a98",600:"#443a77",700:"#302955",800:"#1d1834",900:"#0b0715"}},config:{initialColorMode:"light",useSystemColorMode:!1}}),u=n(17),s=n.n(u),d=n(24),m=n(46),p=n(82),f=n(167),b=n(14),v=n(164),h=n(151),g=n(165),E=n(48),w=n(168),y=n(153),O=n(166),j=n(126),S=n(174),x=n.n(S),k=n(58),C=n(51),D=n(180),A=n(42),I=n(299),_=n(116),$=n(94),F=n(125),M=n(152),P=n(154),R=function(e){var t=e.value,n=Object(b.c)(t),a=n.hasCopied,l=n.onCopy;return r.a.createElement(r.a.Fragment,null,r.a.createElement(h.b,{mb:2},r.a.createElement(M.a,{value:t,isReadOnly:!0,placeholder:"Welcome"}),r.a.createElement(y.a,{onClick:l,ml:2},a?"Copied":"Copy")),r.a.createElement(P.a,{isReadOnly:!0},r.a.createElement(P.c,{width:"100%"}),r.a.createElement(P.b,null)))},z=n(175),U=n.n(z);function B(){return(B=Object(d.a)(s.a.mark((function e(t,n,a){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",U.a.put(t,n,{cancelToken:a&&a.token,headers:{"Content-Type":null===n||void 0===n?void 0:n.type}}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var T=function(e,t,n){return B.apply(this,arguments)},W=new k.GraphQLClient("https://graphql.dev.defencestation.ca/graphql");function q(){return localStorage.getItem("access-token")}var N,L,Q,V=function(){var e=Object(d.a)(s.a.mark((function e(t,n){var a,r,l,c,o,i,u,d,m=arguments;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=m.length>2&&void 0!==m[2]?m[2]:2,r={},q()&&(r={authorization:"".concat(q())}),e.prev=3,e.next=6,W.request(t,n,r);case 6:return l=e.sent,e.abrupt("return",l);case 10:if(e.prev=10,e.t0=e.catch(3),1===a){e.next=16;break}if(!((null===e.t0||void 0===e.t0||null===(c=e.t0.response)||void 0===c||null===(o=c.errors)||void 0===o?void 0:o.length)>0)){e.next=16;break}return"unauthenticated"===(null===e.t0||void 0===e.t0||null===(i=e.t0.response)||void 0===i||null===(u=i.errors[0].extensions)||void 0===u?void 0:u.code)&&(null===e.t0||void 0===e.t0||null===(d=e.t0.response)||void 0===d||d.errors[0].message),e.abrupt("return",V(t,n,a-1));case 16:throw e.t0;case 17:case"end":return e.stop()}}),e,null,[[3,10]])})));return function(t,n){return e.apply(this,arguments)}}(),K=Object(a.createContext)({}),H=Object(k.gql)(N||(N=Object(p.a)(["\n  mutation MyMutation {\n    v1_iam_IAM_UserProfile {\n      user {\n        accountId\n        companyInfoSet\n        email\n        createdAt\n        emailVerified\n        firstName\n        lastName\n        permissions\n        resetOnLogin\n        type\n        updatedAt\n        username\n      }\n    }\n  }\n"]))),J=function(e){var t,n,l,c=e.children,o=Object(C.useQueryClient)(),i=Object(C.useQuery)("userinfo",(function(){return V(H)}),{retry:!1}),u=i.data,m=i.isLoading,f=i.refetch,b=i.isFetching,v=!m&&!(null===u||void 0===u||null===(t=u.v1_iam_IAM_UserProfile)||void 0===t||null===(n=t.user)||void 0===n?void 0:n.username),h=Object(a.useCallback)(Object(d.a)(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,localStorage.removeItem("access-token"),o.clear(),e.abrupt("return",null);case 6:return e.prev=6,e.t0=e.catch(0),e.abrupt("return",e.t0);case 9:case"end":return e.stop()}}),e,null,[[0,6]])}))),[o]),g=Object(k.gql)(L||(L=Object(p.a)(["\n    mutation MyMutation(\n      $email: String!\n      $password: String!\n      $accountid: String!\n      $username: String!\n    ) {\n      v1_authn_Authn_Login(\n        input: {\n          email: $email\n          password: $password\n          accountid: $accountid\n          username: $username\n        }\n      ) {\n        authToken\n        user {\n          accountid\n          companyInfoSet\n          emailVerified\n          firstName\n          lastName\n          type\n          username\n        }\n      }\n    }\n  "]))),E=Object(a.useCallback)(function(){var e=Object(d.a)(s.a.mark((function e(t,n){var a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,V(g,{email:t,password:n,accountid:"abc",username:"abc"});case 3:return 200===(a=e.sent).status&&o.invalidateQueries("userinfo"),e.abrupt("return",a);case 8:if(e.prev=8,e.t0=e.catch(0),!e.t0.response){e.next=12;break}throw e.t0;case 12:throw e.t0;case 13:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t,n){return e.apply(this,arguments)}}(),[g,o]),w=Object(a.useMemo)((function(){var e,t,n;return{isAuthenticated:!!(null===u||void 0===u||null===(e=u.v1_iam_IAM_UserProfile)||void 0===e||null===(t=e.user)||void 0===t?void 0:t.username),user:null===u||void 0===u||null===(n=u.v1_iam_IAM_UserProfile)||void 0===n?void 0:n.user,isFetching:b,isLoading:m,logout:h,login:E,loggedOut:v,refetch:f,revalidate:function(){return o.invalidateQueries("userinfo")}}}),[v,E,h,o,null===u||void 0===u||null===(l=u.v1_iam_IAM_UserProfile)||void 0===l?void 0:l.user,b,m,f]);return r.a.createElement(K.Provider,{value:w},c)},G=n(83),Y=n(84),X=n(179),Z=n(127),ee=n(20),te=n(163),ne=n(176),ae=n.n(ne),re=function(e){return new Promise((function(t,n){var a=new FileReader;a.onload=function(){t(a.result)},a.readAsArrayBuffer(e)}))},le=function(){var e=Object(d.a)(s.a.mark((function e(t,n){var a,r,l,c,o,i,u,d,m,p,f,b,v,h,g;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,re(n);case 3:return a=e.sent,r=new Uint8Array(a),l=1e4,c=new TextEncoder("utf-8").encode(t),o=window.crypto.getRandomValues(new Uint8Array(8)),e.next=10,window.crypto.subtle.importKey("raw",c,{name:"PBKDF2"},!1,["deriveBits"]);case 10:return i=e.sent,e.next=13,window.crypto.subtle.deriveBits({name:"PBKDF2",salt:o,iterations:l,hash:"SHA-256"},i,384);case 13:return u=e.sent,d=new Uint8Array(u),m=d.slice(0,32),p=d.slice(32),e.next=19,window.crypto.subtle.importKey("raw",m,{name:"AES-CBC",length:256},!1,["encrypt"]);case 19:return f=e.sent,e.next=22,window.crypto.subtle.encrypt({name:"AES-CBC",iv:p},f,r);case 22:return b=e.sent,v=new Uint8Array(b),(h=new Uint8Array(v.length+16)).set(new TextEncoder("utf-8").encode("Salted__")),h.set(o,8),h.set(v,16),g=new Blob([h]),e.abrupt("return",g);case 33:throw e.prev=33,e.t0=e.catch(0),console.log("encrypt error"),e.t0;case 37:case"end":return e.stop()}}),e,null,[[0,33]])})));return function(t,n){return e.apply(this,arguments)}}(),ce=function(e){var t,n,l,c=e.setFieldValue,o=e.values,i=e.name,u=e.encryptionKey,m=void 0===u?"hello":u,p=Object(X.a)({onDrop:Object(a.useCallback)(function(){var e=Object(d.a)(s.a.mark((function e(t){var n,a,r,l,u,d;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=Object(Y.a)(o[i]),a=Object(G.a)(t),e.prev=2,a.s();case 4:if((r=a.n()).done){e.next=15;break}return l=r.value,console.log("accepted files"),console.log(l),e.next=10,le(m,l);case 10:u=e.sent,d=new File([u],l.name,{type:u.type}),n=[].concat(Object(Y.a)(n),[d]);case 13:e.next=4;break;case 15:e.next=20;break;case 17:e.prev=17,e.t0=e.catch(2),a.e(e.t0);case 20:return e.prev=20,a.f(),e.finish(20);case 23:c("files",n);case 24:case"end":return e.stop()}}),e,null,[[2,17,20,23]])})));return function(t){return e.apply(this,arguments)}}(),[i,c,o,m])}),f=p.getRootProps,b=p.getInputProps;return r.a.createElement(r.a.Fragment,null,0===(null===(t=o[i])||void 0===t?void 0:t.length)&&r.a.createElement(h.a,Object.assign({},f(),{mb:4,cursor:"pointer",display:"flex",minHeight:100,overflowY:"auto",alignItems:"center",justifyContent:"center",borderWidth:2,p:5,borderRadius:"lg",borderColor:"blue.600",borderStyle:"dashed",css:{"::-webkit-scrollbar":{width:"0px"}}}),r.a.createElement("input",b()),r.a.createElement(h.b,{flexDirection:"column",alignItems:"center"},r.a.createElement(ee.a,{as:Z.a,boxSize:"3em",color:"blue.600",mb:2}),r.a.createElement(h.e,{textAlign:"center",color:"blue.600",fontWeight:"medium",textTransform:"uppercase"},"Click or Drag 'n' Drop Files"))),(null===(n=o[i])||void 0===n?void 0:n.length)>0&&r.a.createElement(h.d,{spacing:4,mt:2,mb:4},null===(l=o[i])||void 0===l?void 0:l.map((function(e){return r.a.createElement(te.a,{key:e.name,variant:"outline",colorScheme:"blue",size:"lg"},r.a.createElement(te.c,null,e.name," - ",ae()(e.size)),r.a.createElement(te.b,{color:"red.800",ml:"auto",onClick:function(){var t,n=null===(t=o[i])||void 0===t?void 0:t.filter((function(t){return e.name!==t.name}));c(i,n)}}))})),r.a.createElement(h.a,null,r.a.createElement(y.a,Object.assign({leftIcon:r.a.createElement(ee.a,{as:Z.a})},f(),{colorScheme:"blue.700",variant:"outline"}),r.a.createElement("input",b()),"Add More Files"))))},oe=Object(k.gql)(Q||(Q=Object(p.a)(['\n  mutation MyMutation(\n    $accountId: String = ""\n    $clickAllowed: Int = 10\n    $endDate: String = ""\n    $fileNames: [String]!\n    $startDate: String = ""\n    $encryptedData: String = ""\n    $username: String = ""\n  ) {\n    v1_secureshare_SecureShare_Create(\n      input: {\n        accountId: $accountId\n        clickAllowed: $clickAllowed\n        endDate: $endDate\n        fileNames: $fileNames\n        startDate: $startDate\n        encryptedData: $encryptedData\n        username: $username\n      }\n    ) {\n      files {\n        name\n        url\n      }\n      uuid\n    }\n  }\n']))),ie=function(){var e=Object(a.useContext)(K).user,t=Object(a.useState)(""),n=Object(m.a)(t,2),l=n[0],c=n[1],o=new Date,i=Object(f.a)(),u=Object(a.useState)([{startDate:Object(A.default)(Object(I.a)(o,15)),endDate:Object(_.default)(o),key:"selection"}]),p=Object(m.a)(u,2),S=p[0],k=p[1],M=Object(b.f)(),P="";var z=Object(v.a)({base:null,lg:"auto"}),U=Object(v.a)({base:!0,lg:!1}),B=Object(v.a)({base:!1,lg:!0}),W=Object(a.useState)(""),q=Object(m.a)(W,2),N=q[0],L=q[1];Object(a.useEffect)((function(){return L(Object(D.a)()),function(){}}),[]);var Q=Object(C.useMutation)((function(e){return V(oe,e)}));return r.a.createElement(h.a,{flex:1},r.a.createElement(h.a,{mb:10},r.a.createElement(h.c,{color:"green.800"},"SecureShare"),r.a.createElement(h.e,{color:"gray.700"},"Share your data securely")),e?r.a.createElement(j.b,{enableReinitialize:!0,initialValues:{data:"",files:[],clickAllowed:12},onSubmit:function(){var t=Object(d.a)(s.a.mark((function t(n,a){var r,l,o,u,m,p,f,b,v,h,g,E,w,y;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a.resetForm,t.prev=1,v=x.a.AES.encrypt(n.data,N).toString(),h=n.files.map((function(e){return e.name})),t.next=6,Q.mutateAsync({accountId:e.accountId,clickAllowed:n.clickAllowed,endDate:null===(r=S[0])||void 0===r||null===(l=r.endDate)||void 0===l?void 0:l.toISOString(),startDate:null===(o=S[0])||void 0===o||null===(u=o.startDate)||void 0===u?void 0:u.toISOString(),username:e.username,encryptedData:v,fileNames:h});case 6:if(g=t.sent,!(E=null===g||void 0===g||null===(m=g.secureshare_SecureShare_Create)||void 0===m?void 0:m.files)){t.next=11;break}return t.next=11,Promise.all(E.map(function(){var e=Object(d.a)(s.a.mark((function e(t){var a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=n.files.filter((function(e){return t.name===e.name})),e.next=3,T(t.url,a[0],null);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 11:c("http://".concat(null===(p=window)||void 0===p||null===(f=p.location)||void 0===f?void 0:f.host,"/app/secure/").concat(null===g||void 0===g||null===(b=g.secureshare_SecureShare_Create)||void 0===b?void 0:b.uuid,"/").concat(N)),i({title:"File encrypted",description:"Files Added",status:"success",duration:3e3,isClosable:!0,position:"top"}),t.next=21;break;case 15:if(t.prev=15,t.t0=t.catch(1),!t.t0.response){t.next=20;break}return i({title:"Response Error",description:null===t.t0||void 0===t.t0||null===(w=t.t0.response)||void 0===w||null===(y=w.errors[0])||void 0===y?void 0:y.message,status:"error",duration:4e3,isClosable:!0,position:"top"}),t.abrupt("return");case 20:i({title:"Application Error",description:t.t0.message,status:"error",duration:4e3,isClosable:!0,position:"top"});case 21:case"end":return t.stop()}}),t,null,[[1,15]])})));return function(e,n){return t.apply(this,arguments)}}()},(function(e){var t=e.values,n=e.isSubmitting,a=e.setFieldValue,c=e.handleChange;return r.a.createElement(j.a,{style:{width:"100%"}},r.a.createElement(h.c,{size:"md",mb:4},"Encrypt a message"),r.a.createElement(g.a,{required:!0,name:"data",value:t.data,placeholder:"Place a message to encrypt here",onChange:c}),r.a.createElement(h.d,{mt:4,flexDirection:{base:"column",md:"row"},justifyContent:"space-between"},r.a.createElement(E.a,{maxWidth:300},r.a.createElement(E.c,null,"Select Access Date Range"),r.a.createElement(h.d,{spacing:2},r.a.createElement(w.a,{matchWidth:!0,placement:"bottom-end",isOpen:M.isOpen,onClose:M.onClose},r.a.createElement(w.h,null,r.a.createElement(h.b,{flexDirection:{base:"row",lg:"row"},tabIndex:"0",role:"button","aria-label":"Date Range",p:2,borderWidth:2,borderRadius:"lg",onClick:M.onOpen,variant:"outline"},r.a.createElement(h.e,{mr:2,color:"green.800",fontWeight:"bold"},Object($.default)(S[0].startDate,"MM/dd/yyyy")),r.a.createElement(h.e,{mr:2},"to"),r.a.createElement(h.e,{color:"green.800",fontWeight:"bold"},Object($.default)(S[0].endDate,"MM/dd/yyyy")))),r.a.createElement(w.e,{width:z},r.a.createElement(w.b,null),r.a.createElement(w.d,null),r.a.createElement(w.g,null,"Date Range"),r.a.createElement(w.c,null,U&&r.a.createElement(F.DateRange,{editableDateInputs:!0,onChange:function(e){e.selection.startDate=Object(A.default)(e.selection.startDate),e.selection.endDate=Object(_.default)(e.selection.endDate),k([e.selection])},moveRangeOnFirstSelection:!1,ranges:S}),B&&r.a.createElement(F.DateRangePicker,{editableDateInputs:!0,onChange:function(e){e.selection.startDate=Object(A.default)(e.selection.startDate),e.selection.endDate=Object(_.default)(e.selection.endDate),k([e.selection])},showSelectionPreview:!0,moveRangeOnFirstSelection:!1,months:1,ranges:S,direction:"horizontal"})),r.a.createElement(w.f,{d:"flex",justifyContent:"flex-end"},r.a.createElement(y.a,{colorScheme:"blue",onClick:function(){M.onClose()}},"Apply"))))),r.a.createElement(E.b,null,"Choose when you want message to be accessed")),r.a.createElement(E.a,{maxWidth:300,ml:"auto"},r.a.createElement(E.c,{htmlFor:"email"},"Allowed Opens"),r.a.createElement(O.c,{min:1,required:!0,onChange:function(e,t){a("clickAllowed",t)},value:t.clickAllowed},r.a.createElement(O.d,null),r.a.createElement(O.e,null,r.a.createElement(O.b,null),r.a.createElement(O.a,null))),r.a.createElement(E.b,null,"The amount of time the message can be accessed"))),r.a.createElement(h.a,{mt:4},r.a.createElement(ce,{name:"files",setFieldValue:a,values:t,encryptionKey:N}),l&&r.a.createElement(R,{value:l}),r.a.createElement(h.b,{justifyContent:"center"},r.a.createElement(y.a,{size:"lg",colorScheme:"blue",mr:3,type:"submit",isLoading:n},"Encrypt"))))})):r.a.createElement("div",null,r.a.createElement("h1",null," Enter Token "),r.a.createElement(g.a,{placeholder:"Enter Token",onChange:function(e){console.log(e.target.value),P=e.target.value}}," "),r.a.createElement("br",null),r.a.createElement(y.a,{size:"lg",colorScheme:"blue",mr:3,onClick:function(){localStorage.setItem("access-token",P),window.location.reload()}},"Login")))},ue=(n(285),n(286),new C.QueryClient);var se=function(){return r.a.createElement(C.QueryClientProvider,{client:ue},r.a.createElement(J,null,r.a.createElement(o.a,{resetCSS:!0,theme:i},r.a.createElement(ie,null))))};c.a.render(r.a.createElement(r.a.Fragment,null,r.a.createElement(se,null)),document.getElementById("modal-window"))}},[[210,1,2]]]);
//# sourceMappingURL=main.39f32f36.chunk.js.map